<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="/lib/flexible.js"></script>
    <script src="/lib/echarts.min.js"></script>
    <script src="/lib/jquery.min.js"></script>
    <script src="/lib/echarts-gl.min.js"></script>
    <script src="/lib/bmap.min.js"></script>
    <script src="http://api.map.baidu.com/api?v=2.0&ak=gBxjOkvaV2UPxn3O7oKwt1IL5ZpRUCvZ"></script>
    <title>1</title>
</head>

<body>
<div class="con right" style="width:50%;position:relative;">
    <div class="div_any">
        <div class="left div_any01" style="width:100%;">
            <div class="div_any_child" style="width:98%;position:relative;height: 13.125rem;">
                <div class="div_any_title">气象情况地图</div>
                <div id="wind" style="width:98%;position:relative;left:1%;height: 12.5rem;top:0.3125rem"></div>
            </div>
        </div>
    </div>
</div>
</body>

<script>
    var colors = ['#20bf6b', '#0fb9b1', '#f7b731', '#fa8231', '#eb3b5a', '#6F1E51', '#1e90ff', '#5352ed', '#3742fa', '#3c40c6'];
    var arr = ['PM2.5', 'PM10', 'SO2', 'NO2', 'CO', 'O3', 'U', 'V', 'TEMP', 'RH', 'PSFC']
    var mCharts4 = echarts.init(document.getElementById('wind'), 'light');
    var year = 2013;
    var month = 1;
    var day = 1;
    var curtain = 0;
    var url4 = '/data/1.json';

    function dataChange4(url) {
        var data = [];
        var maxMag = 0;
        var minMag = Infinity;
        $.get(url, function (ret) {
            var obj = ret.data;
            for (var i = 0; i < obj.length; i++) {
                var u = obj[i][0]; // 纬向风速
                var v = obj[i][1]; // 经向风速
                var mag = Math.sqrt(u * u + v * v);
                var lat = obj[i][2]; // 纬度
                var lon = obj[i][3]; // 经度
                var itemArr = [lon, lat, v, u, mag];
                data.push(itemArr);
                maxMag = Math.max(mag, maxMag);
                minMag = Math.min(mag, minMag);
            }
            var trajectory = [];
            var series2 = [{
                type: 'flowGL',
                coordinateSystem: 'bmap',
                data: data,
                supersampling: 4,
                particleType: 'line',
                particleDensity: 90,
                particleSpeed: 5,
                itemStyle: {
                    opacity: 0.9
                }
            }];

            mCharts4.setOption({
                title: {
                    show: true,
                    text: '全国' + year + '年' + month + '月' + day + '日风向图',
                    left: 'center',
                    textStyle: {
                        color: '#fff'
                    }
                },
                visualMap: {
                    left: 'right',
                    min: minMag,
                    max: maxMag,
                    dimension: 4,
                    inRange: {
                        color: ['#313695', '#4575b4', '#74add1', '#abd9e9', '#e0f3f8', '#ffffbf', '#fee090', '#fdae61', '#f46d43', '#d73027', '#a50026']
                    },
                    realtime: false,
                    calculable: true,
                    textStyle: {
                        color: '#fff'
                    }
                },
                bmap: {
                    center: [105, 38],
                    zoom: 5,
                    roam: true,
                    mapStyle: {
                        styleJson: [
                            {
                                featureType: "water",
                                elementType: "all",
                                stylers: {
                                    color: "#273c75"
                                }
                            },
                            // 根据需要自定义地图样式
                        ]
                    }
                },
                series: series2
            });
        });
        curtain = 4;
    }

    dataChange4(url4);
</script>

</html>
